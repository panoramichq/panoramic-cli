WITH __om_om_slug_425e4946debaef61 AS 
(SELECT 'my-val' AS original, 'new-val' AS changed UNION ALL SELECT CAST(NULL AS VARCHAR) AS original, 'Another val' AS changed UNION ALL SELECT 'orig-val' AS original, '--PANO-NULL--' AS changed)
 SELECT comparison_cpm_d3fa58a941286552 AS comparison_cpm_d3fa58a941286552, cpm AS cpm, objective AS objective 
FROM (SELECT __comparison_cpm1_2d896dd702f7d8cd / nullif(__comparison_cpm2_5d8099c8e1b3d8ca, 0) AS comparison_cpm_d3fa58a941286552, __cpm1 / nullif(__cpm2, 0) AS cpm, objective AS objective 
FROM (SELECT sum(1000 * comparison_spend_5eb761e62a53b4c0) AS __comparison_cpm1_2d896dd702f7d8cd, sum(comparison_impressions_2b66864e9ec66eff) AS __comparison_cpm2_5d8099c8e1b3d8ca, sum(1000 * spend) AS __cpm1, sum(impressions) AS __cpm2, objective AS objective 
FROM (SELECT data_dataframe.comp_join_col_fb_tw_merged_objective_override_unknowns AS comp_join_col_fb_tw_merged_objective_override_unknowns, comparison_dataframe.comparison_facebook_ads_spend_ee3c8ce54c851643 AS comparison_facebook_ads_spend_ee3c8ce54c851643, comparison_dataframe.comparison_spend_5eb761e62a53b4c0 AS comparison_spend_5eb761e62a53b4c0, comparison_dataframe.comparison_twitter_spend_effa7799eeeb7d89 AS comparison_twitter_spend_effa7799eeeb7d89, data_dataframe.facebook_ads_objective_c6ca42e81dd77539 AS facebook_ads_objective_c6ca42e81dd77539, data_dataframe.facebook_ads_spend_5811c78c7c741b5a AS facebook_ads_spend_5811c78c7c741b5a, data_dataframe.objective AS objective, data_dataframe.spend AS spend, data_dataframe.twitter_impressions_ef12a84724a0ad7d AS twitter_impressions_ef12a84724a0ad7d, data_dataframe.twitter_objective_bf8f938b0fc50b79 AS twitter_objective_bf8f938b0fc50b79, data_dataframe.twitter_spend_68657fbb141b10c8 AS twitter_spend_68657fbb141b10c8 
FROM (SELECT __comp_join_col_fb_tw_merged_objective_override_unknowns1, __comp_join_col_fb_tw_merged_objective_override_unknowns2, CASE WHEN (__om_coalesce___comp_join_col_fb_tw_merged_o_b09097e3a50c0f5f.changed = '--PANO-NULL--') THEN NULL ELSE coalesce(__om_coalesce___comp_join_col_fb_tw_merged_o_b09097e3a50c0f5f.changed, 'Unknown') END AS comp_join_col_fb_tw_merged_objective_override_unknowns, facebook_ads_objective_c6ca42e81dd77539, facebook_ads_spend_5811c78c7c741b5a, objective, spend, twitter_impressions_ef12a84724a0ad7d, twitter_objective_bf8f938b0fc50b79, twitter_spend_68657fbb141b10c8 
FROM (SELECT __comp_join_col_fb_tw_merged_objective_override_unknowns1, __comp_join_col_fb_tw_merged_objective_override_unknowns2, facebook_ads_objective_c6ca42e81dd77539, facebook_ads_spend_5811c78c7c741b5a, objective, spend, twitter_impressions_ef12a84724a0ad7d, twitter_objective_bf8f938b0fc50b79, twitter_spend_68657fbb141b10c8 
FROM (SELECT q1.facebook_ads_objective_c6ca42e81dd77539 AS facebook_ads_objective_c6ca42e81dd77539, sum(q1.facebook_ads_spend_5811c78c7c741b5a) as facebook_ads_spend_5811c78c7c741b5a, coalesce(q0.objective, q1.objective) AS objective, sum(coalesce(q0.spend,0)+coalesce(q1.spend,0)) as spend, sum(q0.twitter_impressions_ef12a84724a0ad7d) as twitter_impressions_ef12a84724a0ad7d, q0.twitter_objective_bf8f938b0fc50b79 AS twitter_objective_bf8f938b0fc50b79, sum(q0.twitter_spend_68657fbb141b10c8) as twitter_spend_68657fbb141b10c8, __comp_join_col_fb_tw_merged_objective_override_unknowns1, __comp_join_col_fb_tw_merged_objective_override_unknowns2 
FROM (SELECT twitter_column_mock, __data_source 
FROM twitter_table_mock) AS q0 FULL OUTER JOIN (SELECT facebook_column_mock, __data_source 
FROM facebook_table_mock) AS q1 ON q0.__data_source = q1.__data_source GROUP BY q1.facebook_ads_objective_c6ca42e81dd77539, coalesce(q0.objective, q1.objective), q0.twitter_objective_bf8f938b0fc50b79, __comp_join_col_fb_tw_merged_objective_override_unknowns1, __comp_join_col_fb_tw_merged_objective_override_unknowns2)) LEFT OUTER JOIN __om_om_slug_425e4946debaef61 AS __om_coalesce___comp_join_col_fb_tw_merged_o_b09097e3a50c0f5f ON __om_coalesce___comp_join_col_fb_tw_merged_o_b09097e3a50c0f5f.original = coalesce(__comp_join_col_fb_tw_merged_objective_override_unknowns1, __comp_join_col_fb_tw_merged_objective_override_unknowns2) OR __om_coalesce___comp_join_col_fb_tw_merged_o_b09097e3a50c0f5f.original IS NULL AND coalesce(__comp_join_col_fb_tw_merged_objective_override_unknowns1, __comp_join_col_fb_tw_merged_objective_override_unknowns2) IS NULL) AS data_dataframe LEFT OUTER JOIN (SELECT comp_join_col_fb_tw_merged_objective_override_unknowns, sum(comparison_facebook_ads_spend_ee3c8ce54c851643) AS comparison_facebook_ads_spend_ee3c8ce54c851643, sum(comparison_spend_5eb761e62a53b4c0) AS comparison_spend_5eb761e62a53b4c0, sum(comparison_twitter_spend_effa7799eeeb7d89) AS comparison_twitter_spend_effa7799eeeb7d89, facebook_ads_objective_c6ca42e81dd77539, objective, twitter_objective_bf8f938b0fc50b79 
FROM (SELECT __comp_join_col_fb_tw_merged_objective_override_unknowns1, __comp_join_col_fb_tw_merged_objective_override_unknowns2, CASE WHEN (__om_coalesce___comp_join_col_fb_tw_merged_o_b09097e3a50c0f5f.changed = '--PANO-NULL--') THEN NULL ELSE coalesce(__om_coalesce___comp_join_col_fb_tw_merged_o_b09097e3a50c0f5f.changed, 'Unknown') END AS comp_join_col_fb_tw_merged_objective_override_unknowns, comparison_facebook_ads_spend_ee3c8ce54c851643, comparison_spend_5eb761e62a53b4c0, comparison_twitter_spend_effa7799eeeb7d89, facebook_ads_objective_c6ca42e81dd77539, objective, twitter_objective_bf8f938b0fc50b79 
FROM (SELECT __comp_join_col_fb_tw_merged_objective_override_unknowns1, __comp_join_col_fb_tw_merged_objective_override_unknowns2, facebook_ads_spend_5811c78c7c741b5a AS comparison_facebook_ads_spend_ee3c8ce54c851643, spend AS comparison_spend_5eb761e62a53b4c0, twitter_spend_68657fbb141b10c8 AS comparison_twitter_spend_effa7799eeeb7d89, facebook_ads_objective_c6ca42e81dd77539 AS facebook_ads_objective_c6ca42e81dd77539, objective AS objective, twitter_objective_bf8f938b0fc50b79 AS twitter_objective_bf8f938b0fc50b79 
FROM (SELECT __comp_join_col_fb_tw_merged_objective_override_unknowns1, __comp_join_col_fb_tw_merged_objective_override_unknowns2, facebook_ads_objective_c6ca42e81dd77539, facebook_ads_spend_5811c78c7c741b5a, objective, spend, twitter_objective_bf8f938b0fc50b79, twitter_spend_68657fbb141b10c8 
FROM (SELECT q1.facebook_ads_objective_c6ca42e81dd77539 AS facebook_ads_objective_c6ca42e81dd77539, sum(q1.facebook_ads_spend_5811c78c7c741b5a) as facebook_ads_spend_5811c78c7c741b5a, coalesce(q0.objective, q1.objective) AS objective, sum(coalesce(q0.spend,0)+coalesce(q1.spend,0)) as spend, q0.twitter_objective_bf8f938b0fc50b79 AS twitter_objective_bf8f938b0fc50b79, sum(q0.twitter_spend_68657fbb141b10c8) as twitter_spend_68657fbb141b10c8, __comp_join_col_fb_tw_merged_objective_override_unknowns1, __comp_join_col_fb_tw_merged_objective_override_unknowns2 
FROM (SELECT twitter_comparison_column_mock, __data_source 
FROM twitter_comparison_table_mock) AS q0 FULL OUTER JOIN (SELECT facebook_comparison_column_mock, __data_source 
FROM facebook_comparison_table_mock) AS q1 ON q0.__data_source = q1.__data_source GROUP BY q1.facebook_ads_objective_c6ca42e81dd77539, coalesce(q0.objective, q1.objective), q0.twitter_objective_bf8f938b0fc50b79, __comp_join_col_fb_tw_merged_objective_override_unknowns1, __comp_join_col_fb_tw_merged_objective_override_unknowns2))) LEFT OUTER JOIN __om_om_slug_425e4946debaef61 AS __om_coalesce___comp_join_col_fb_tw_merged_o_b09097e3a50c0f5f ON __om_coalesce___comp_join_col_fb_tw_merged_o_b09097e3a50c0f5f.original = coalesce(__comp_join_col_fb_tw_merged_objective_override_unknowns1, __comp_join_col_fb_tw_merged_objective_override_unknowns2) OR __om_coalesce___comp_join_col_fb_tw_merged_o_b09097e3a50c0f5f.original IS NULL AND coalesce(__comp_join_col_fb_tw_merged_objective_override_unknowns1, __comp_join_col_fb_tw_merged_objective_override_unknowns2) IS NULL) GROUP BY comp_join_col_fb_tw_merged_objective_override_unknowns, twitter_objective_bf8f938b0fc50b79, objective, facebook_ads_objective_c6ca42e81dd77539) AS comparison_dataframe ON data_dataframe.comp_join_col_fb_tw_merged_objective_override_unknowns = comparison_dataframe.comp_join_col_fb_tw_merged_objective_override_unknowns OR (data_dataframe.comp_join_col_fb_tw_merged_objective_override_unknowns IS NULL AND comparison_dataframe.comp_join_col_fb_tw_merged_objective_override_unknowns IS NULL)) GROUP BY objective))
 LIMIT 100